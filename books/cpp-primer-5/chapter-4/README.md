# 第 4 章    表达式

## 练习 4.1

> 表达式 5+10*20/2 的求值结果是多少？

(10 * 20 / 2) + 5 => 105



## 练习 4.2

> 根据 4.12 节中的表，在下述表达式的合理位置添加括号，使得添加括号后运算对象的组合顺序与添加括号前一致。
>
> ```cpp
> (a)  *vec.begin()                        (b)  *vec.begin() + 1
> ```

- (a)  `* (vec.begin())`
- (b) `(* (vec.begin())) + 1`



## 练习 4.3

> C\+\+语言没有明确规定大多数二元运算符的求值顺序，给编译器优化留下了余地。这种策略实际上是在代码生成效率和程序潜在缺陷之间进行了权衡，你认为这可以接受吗？请说出你的理由。

不可以接受，像Java针对求值顺序有明确规定，保证了代码逻辑的一致性，不会导致未定义行为的发生，减少程序错误。然而在C\+\+里，需要非常注意这种未定义行为，这虽然可以提高编译器的优化，但是牺牲了健壮性。不过C\+\+都是这样的尿性，为了性能可以权衡。

当然，对于这一设计目的为了性能也是没办法的事，作为开发者主要做的就是避免写未定义行为的代码，譬如`cout << i++ << i << endl;`这种。



## 练习 4.4

> 在下面的表达式中添加括号，说明其求值的过程及最终结果。编写程序编译该（不加括号）表达式并输出其结果验证之前的推断。
>
> ```cpp
> 12 / 3 * 4 + 5 * 15 + 24 % 4 / 2
> ```

加括号后为 

```cpp
(((12 / 3) * 4) + (5 * 15)) + ((24 % 4) / 2)
// => (4 * 4) + 75 + (0 / 2)
// => 16 + 75 + 0
// => 91
```



## 练习 4.5

> 写出下列表达式的求值结果。
>
> ```cpp
> (a)  -30 * 3 + 21 / 5                    (b)  -30 + 3 * 21 / 5
> (c)  30 / 3 * 21 % 5                     (d)  -30 / 3 * 21 % 4
> ```

- (a) -90 + 4 = -86
- (b) -30 + 63 / 5 = -30 + 12 = -18
- (c) 10 * 21 % 5 = 210 % 5 = 0
- (d) -10 * 21 % 4 = -210 % 4 = -2



## 练习 4.6

> 写出一条表达式用于确定一个整数是奇数还是偶数。

` i % 2 == 0 ? "even" : "odd"`



## 练习 4.7

> 溢出是何含义？写出三条将导致溢出的表达式。

```cpp
short svalue = 32767; ++svalue;  // -32768
unsigned uivalue = 0; --uivalue; // 4294967295
unsigned short usvalue - 65535; ++usvalue; // 0
```



## 练习 4.8

> 说明在逻辑与、逻辑或和相等性运算符中运算对象求值的顺序。

逻辑与和逻辑或运算符都是先求左侧运算对象的值再求右侧运算对象的值，当且仅当左侧运算对象无法确定表达式的结果时才会计算右侧运算对象的值。这种策略称为**短路求值**（short-circuit evaluation）。

- 逻辑与：当且仅当左侧运算对象为真时才对右侧运算对象求值
- 逻辑或：当且仅当左侧运算对象为假时才对右侧运算对象求值
- 相等性运算符：当且仅当两个运算对象的值相等才为真，否则返回假。C\+\+没有规定求值顺序。



## 练习 4.9

> 解释在下面的`if`语句中条件部分的判断过程。
>
> ```cpp
> const char *cp = "Hello World";
> if (cp && *cp)
> ```

首先判断`cp`，它是指向常量的指针，并且不为`nullptr`，值为`true`；然后计算`*cp`对象的值，它指向的是`const char`并且指向对象的值为`'H'`，转换为`int`肯定不为0，所以值依然为`true`。

则表达式同等于`true && true`，最后结果为`true`。



## 练习 4.10 

> 为`while`循环写一个条件，使其从标准输入中读取整数，遇到 42 时停止。

```cpp
int input = 0;
while (cin >> i && i != 42)
```



## 练习 4.11

> 书写一条表达式用于测试 4 个值`a, b, c, d`的关系，确保`a`大于`b`、`b`大于`c`、`c`大于`d`。

```cpp
a > b && b > c && c > d
```



## 练习 4.12

> 假设`i`、`j`和`k`都是三个整数，说明表达式`i != j < k`的含义。

根据运算符优先级，表达式`i != j < k`等同于`i != (j < k)`。所以先计算子表达式`j < k`的值，返回为`true`或者`false`，`!=`运算符右侧变成`bool`类型。而 `i` 是`int`类型，则会把右侧布尔类型运算对象提升为 1 或者 0，最后的比较就是 `i`是否不等于 1 或者 0。



## 练习 4.13

> 